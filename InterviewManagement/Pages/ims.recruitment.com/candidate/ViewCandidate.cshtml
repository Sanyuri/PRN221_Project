@page
@model InterviewManagement.Pages.ims.recruitment.com.candidate.ViewCandidateModel

@{
    ViewData["Title"] = "View Candidate";
    Layout = "~/Pages/Shared/_Layout1.cshtml";
}

<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>View Candidate</title>

</head>
<body>
    @if (Model.Candidate != null)
    {
        <div>
            <div class="row">
                <div class="d-flex justify-content-between align-items-center">
                    <strong>I. Personal information</strong>
                    <div>
                        Created on <span>@(Model.Candidate.CreatedOn?.ToString("dd-MM-yyyy") ?? "Not available")</span>,
                        last updated by <span>@Model.Candidate.ModifiedBy</span>

                        @if (ViewBag.User != "Interviewer" && Model.Candidate.Status!="13")
                        {
                            <button class="btn btn-danger ban-button" href="#">Ban Candidate</button>
                            
                        }
                    </div>
                </div>

                <div class="col-md-6 mb-3">
                    <label class="form-label">Full Name</label>
                    <input type="text" class="form-control" value="@Model.Candidate.FullName" readonly />
                </div>

                <div class="col-md-6 mb-3">
                    <label class="form-label">Email</label>
                    <input type="text" class="form-control" value="@Model.Candidate.Email" readonly />
                </div>

                <div class="col-md-6 mb-3">
                    <label class="form-label">D.O.B</label>
                    <input type="date" class="form-control" value="@Model.Candidate.dob.ToString("yyyy-MM-dd")" readonly />
                </div>

                <div class="col-md-6 mb-3">
                    <label class="form-label">Address</label>
                    <input type="text" class="form-control" value="@Model.Candidate.Address" readonly />
                </div>

                <div class="col-md-6 mb-3">
                    <label class="form-label">Phone Number</label>
                    <input type="text" class="form-control" value="@Model.Candidate.PhoneNumber" readonly />
                </div>

                <div class="col-md-6 mb-3">
                    <label class="form-label">Gender</label>
                    <input type="text" class="form-control" value="@Model.Candidate.Gender" readonly />
                </div>

                <strong>II. Professional information</strong>

                <div class="col-md-6 mb-3">
                    <label class="form-label">CV attachment</label>
                    <input type="text" class="form-control mdi-attachment" value="@Model.Candidate.CvLink" readonly />
                </div>

                <div class="col-md-6 mb-3">
                    <label class="form-label">Note</label>
                    <input type="text" class="form-control" value="@Model.Candidate.Note" readonly />
                </div>

                <div class="col-md-6 mb-3">
                    <label class="form-label">Position</label>
                    <input type="text" class="form-control" value="@Model.Candidate.Position?.PositionName" readonly />
                </div>

                <div class="col-md-6 mb-3">
                    <label class="form-label">Status</label>
                    @if (ViewData["status"] is IDictionary<int, string> status)
                    {
                        if (int.TryParse(Model.Candidate.Status, out int statusKey) && status.TryGetValue(statusKey, out string? statusName))
                        {
                            <input type="text" class="form-control" value="@statusName" readonly />
                        }
                    }
                </div>

                <div class="col-md-6 mb-3">
                    <label class="form-label">Skills</label>
                    <div class="form-control d-flex">
                        @if (Model.Candidate.Skills != null)
                        {
                            @foreach (var skill in Model.Candidate.Skills)
                            {
                                <div class="border mx-1 rounded-pill p-1" style="background-color: #0dcaf0; color: white" readonly="">@skill.SkillName</div>
                            }
                        }
                    </div>
                </div>

                <div class="col-md-6 mb-3">
                    <label class="form-label">Years of experience</label>
                    <input type="text" class="form-control" value="@Model.Candidate.ExpYear" readonly />
                </div>

                <div class="col-md-6 mb-3">
                    <label class="form-label">Recruiter</label>
                    <input type="text" class="form-control" value="@Model.Candidate.Employee?.FullName" readonly />
                </div>

                <div class="col-md-6 mb-3">
                    <label class="form-label">Highest Level</label>
                    <input type="text" class="form-control" value="@Model.Candidate.HighestLevel?.Name" readonly />
                </div>
            </div>
        </div>
    }
    <div class="modal fade" id="banModal" tabindex="-1" aria-labelledby="banModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="banModalLabel">Are you sure you want to ban this candidate? </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" id="addModalBody">
                    <!-- Content will be loaded here -->
                    <form method="post">
                        <input type="hidden" value="@Model.Candidate.Id" name="idChanfer" />

                        <input type="submit" value="Yes" class="btn btn-danger" /> |
                        <a asp-page="./Index" class="btn btn-secondary" data-dismiss="modal">No</a>
                    </form>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
@section Scripts {
<script>
        $(document).ready(function () {
            $('.ban-button').on('click', function () {
                $('#banModal').modal('show');
            });
        });
</script>
}